<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Admin Login ‚Äì MS MART</title>

<script type="module" src="../js/firebase.js"></script>

<style>
  body {
    margin: 0;
    font-family: Arial;
    background: #f2f2f2;
  }

  .login-box {
    max-width: 380px;
    margin: 80px auto;
    background: #fff;
    padding: 25px;
    border-radius: 12px;
    box-shadow: 0 0 12px rgba(0,0,0,0.2);
  }

  h2 {
    text-align: center;
    margin-bottom: 18px;
  }

  input {
    width: 100%;
    padding: 12px;
    border-radius: 8px;
    border: 1px solid #ccc;
    margin-bottom: 12px;
    font-size: 15px;
  }

  .password-container {
    position: relative;
  }

  .eye-icon {
    position: absolute;
    right: 12px;
    top: 12px;
    cursor: pointer;
    font-size: 20px;
    color: #333;
  }

  button {
    width: 100%;
    padding: 12px;
    background: #0a8;
    color: white;
    border: none;
    font-size: 16px;
    border-radius: 8px;
    cursor: pointer;
  }

  .error-msg {
    color: red;
    font-size: 14px;
    margin-top: 8px;
    text-align: center;
  }
</style>
</head>

<body>

<div class="login-box">
  <h2>Admin Login</h2>

  <input id="email" placeholder="Enter Admin Email">

  <div class="password-container">
    <input id="password" type="password" placeholder="Enter Password">
    <span class="eye-icon" id="toggleEye">üëÅ</span>
  </div>

  <button id="loginBtn">Login</button>

  <div id="errorMsg" class="error-msg"></div>
</div>

<script type="module">
  // 1. Firebase ‡∞®‡∞ø ‡∞á‡∞ï‡±ç‡∞ï‡∞°‡±á ‡∞á‡∞Ç‡∞™‡±ã‡∞∞‡±ç‡∞ü‡±ç ‡∞ö‡±á‡∞∏‡±ç‡∞§‡±Å‡∞®‡±ç‡∞®‡∞æ‡∞Ç
  import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
  import { getAuth, signInWithEmailAndPassword } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";

  // 2. ‡∞Æ‡±Ä Firebase Config ‡∞á‡∞ï‡±ç‡∞ï‡∞° ‡∞™‡±á‡∞∏‡±ç‡∞ü‡±ç ‡∞ö‡±á‡∞Ø‡∞Ç‡∞°‡∞ø
const firebaseConfig = {
  apiKey: "AIzaSyAb7lILQF-Cd27aKmRJ2mOoEUtiMsYgcww",
  authDomain: "msmart-2ce7c.firebaseapp.com",
  projectId: "msmart-2ce7c",
  storageBucket: "msmart-2ce7c.firebasestorage.app",
  messagingSenderId: "844751147092",
  appId: "1:844751147092:web:89ed978077d83622765dc1",
  measurementId: "G-HXH0HPHE0W"
};
  // 3. App ‡∞®‡∞ø ‡∞∏‡±ç‡∞ü‡∞æ‡∞∞‡±ç‡∞ü‡±ç ‡∞ö‡±á‡∞∏‡±ç‡∞§‡±Å‡∞®‡±ç‡∞®‡∞æ‡∞Ç
  const app = initializeApp(firebaseConfig);
  const auth = getAuth(app);

  // 4. HTML ‡∞é‡∞≤‡∞ø‡∞Æ‡±Ü‡∞Ç‡∞ü‡±ç‡∞∏‡±ç ‡∞®‡∞ø ‡∞§‡±Ä‡∞∏‡±Å‡∞ï‡±Å‡∞Ç‡∞ü‡±Å‡∞®‡±ç‡∞®‡∞æ‡∞Ç
  const emailInput = document.getElementById("email");
  const passInput = document.getElementById("password");
  const loginBtn = document.getElementById("loginBtn");
  const errorMsg = document.getElementById("errorMsg");
  const toggleEye = document.getElementById("toggleEye");

  // ‡∞™‡∞æ‡∞∏‡±ç‚Äå‡∞µ‡∞∞‡±ç‡∞°‡±ç ‡∞ï‡∞®‡∞ø‡∞™‡∞ø‡∞Ç‡∞ö‡±á‡∞≤‡∞æ/‡∞¶‡∞æ‡∞ö‡±á‡∞≤‡∞æ ‡∞ö‡±á‡∞∏‡±á ‡∞ï‡±ã‡∞°‡±ç
  toggleEye.onclick = () => {
    if (passInput.type === "password") {
      passInput.type = "text";
      toggleEye.textContent = "üôà";
    } else {
      passInput.type = "password";
      toggleEye.textContent = "üëÅ";
    }
  };

  // ‡∞≤‡∞æ‡∞ó‡∞ø‡∞®‡±ç ‡∞¨‡∞ü‡∞®‡±ç ‡∞®‡±ä‡∞ï‡±ç‡∞ï‡∞ø‡∞®‡∞™‡±ç‡∞™‡±Å‡∞°‡±Å ‡∞ú‡∞∞‡∞ø‡∞ó‡±á ‡∞™‡±ç‡∞∞‡∞æ‡∞∏‡±Ü‡∞∏‡±ç
  loginBtn.onclick = async () => {
    const email = emailInput.value.trim();
    const pass  = passInput.value.trim();
    
    // ‡∞™‡∞æ‡∞§ ‡∞é‡∞∞‡±ç‡∞∞‡∞∞‡±ç‡∞∏‡±ç ‡∞ï‡±ç‡∞≤‡∞ø‡∞Ø‡∞∞‡±ç ‡∞ö‡±á‡∞∏‡±ç‡∞§‡±Å‡∞®‡±ç‡∞®‡∞æ‡∞Ç
    errorMsg.textContent = "Checking..."; 
    errorMsg.style.color = "blue";

    if (!email || !pass) {
      errorMsg.textContent = "‚ö† Email and password required";
      errorMsg.style.color = "red";
      return;
    }

    try {
      // Firebase ‡∞≤‡∞æ‡∞ó‡∞ø‡∞®‡±ç ‡∞ö‡±Ü‡∞ï‡∞ø‡∞Ç‡∞ó‡±ç
      await signInWithEmailAndPassword(auth, email, pass);
      
      // ‡∞∏‡∞ï‡±ç‡∞∏‡±Ü‡∞∏‡±ç ‡∞Ö‡∞Ø‡∞ø‡∞§‡±á ‡∞°‡∞æ‡∞∑‡±ç‚Äå‡∞¨‡±ã‡∞∞‡±ç‡∞°‡±ç‚Äå‡∞ï‡∞ø ‡∞µ‡±Ü‡∞≥‡±ç‡∞§‡±Å‡∞Ç‡∞¶‡∞ø
      alert("Login Successful!"); // ‡∞ü‡±Ü‡∞∏‡±ç‡∞ü‡∞ø‡∞Ç‡∞ó‡±ç ‡∞ï‡±ã‡∞∏‡∞Ç ‡∞Ö‡∞≤‡∞∞‡±ç‡∞ü‡±ç
      window.location.href = "index.html";

    } catch (err) {
      console.error(err); // ‡∞é‡∞∞‡±ç‡∞∞‡∞∞‡±ç ‡∞®‡∞ø ‡∞ï‡∞®‡±ç‡∞∏‡±ã‡∞≤‡±ç ‡∞≤‡±ã ‡∞™‡±ç‡∞∞‡∞ø‡∞Ç‡∞ü‡±ç ‡∞ö‡±á‡∞∏‡±ç‡∞§‡±Å‡∞Ç‡∞¶‡∞ø
      errorMsg.style.color = "red";
      
      // ‡∞é‡∞∞‡±ç‡∞∞‡∞∞‡±ç ‡∞Æ‡±Ü‡∞∏‡±á‡∞ú‡±ç ‡∞ö‡±Ç‡∞™‡∞ø‡∞Ç‡∞ö‡∞°‡∞Ç
      if (err.code === "auth/invalid-credential" || err.code === "auth/user-not-found" || err.code === "auth/wrong-password") {
        errorMsg.textContent = "‚ùå Incorrect Email or Password";
      } else {
        errorMsg.textContent = "‚ö† Error: " + err.message;
      }
    }
  };
</script>

</body>
</html>
